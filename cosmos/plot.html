<!--6/2/2020 fixed 'clear' to show fixed clues in matrix. moved buttons to top
  5/2/2020 want to have clear matrix always show the three given substitutions-done
   maybe need a checkbox to allow choice - retain all 'n' values or only the three initial
  4/2/2020 changed under chart numbers to clickable images by using innerHTML build
  3/2/2020 'new image' does not accept 'onclick'. To make that work,
  use innerHTML with prototype like "<img id='ii' src='black.png' onclick='showmatrix()'>;"
  3/2/2020 trials of text data matrix from tabbed data
  2/1/2020 line and bar version with values-->
<!DOCTYPE=html>
<html>
<title> Show letter frequencies</title>
<h1>COSMOS puzzle 'assistant'<h1>
<div class='div1' align='left' >
<img src='showplot.png' onclick='chartfreqs()' >
<img src='showmatrix.png' onclick='showmatrix()' >

</div>
<head>
<style>
.butt{
border: 2px solid #00ff00;
}
.div1{
align: 'center'
}
.rectangle{
width:460px;height:460px;background:#eeeeff;
}
</style>
<div id='header' >
<div id='cnv' align='left'>
<canvas id='canvas' height='250'; width='780' style="border:2px solid black;"></canvas>
</div>
<div id='div1' align='left'></div>
<div id='matrix' </dv>

<script>
var clues="M,9,N,13,G,19";
var efreq="8.45,1.43,3.59,3.75,12.21,2.12,1.55,4.05,7.83,0.32,0.63,3.97,2.48,6.65,7.77,1.74,0.18,6.76,7.16,9.26,2.74,1.56,1.40,0.25,2.02,0.13";
var freq=[11,1,1,1,22,10,4,1,6,1,16,14,7,3,1,4,12,9,4,12,2,4,1,9,1,4];
var matrixdata="12	9	13	17	16	12	1	11	0	5	14	5	20	26	24	\
22	0	12	0	5	0	5	0	24	0	11	0	5	0	17	\ 25	5	1	7	24	18	17	20	15	0	11	22	20	11	6	\ 9	0	9	0	20	0	13	0	11	0	24	0	5	0	16	\ 12	8	5	4	26	11	0	14	6	12	10	21	12	6	11	\ 1	0	18	0	6	0	24	0	11	0	5	0	0	0	1	\ 12	22	17	7	5	13	18	0	18	12	22	17	13	24	0	\ 13	0	16	0	1	0	1	0	5	0	0	0	11	0	17	\ 0	19	11	6	0	23	5	6	6	5	20	17	12	26	24	\ 7	0	0	0	5	0	18	0	0	0	1	0	6	0	12	\ 12	16	11	1	19	1	5	3	11	0	26	14	12	5	18	\ 9	0	2	0	1	0	19	0	5	0	20	0	19	0	12	\ 17	20	11	0	11	6	11	20	18	1	17	20	17	5	13	\ 13	0	20	0	11	0	9	0	0	0	5	0	24	0	17	\ 12	20	18	5	7	24	0	18	21	5	6	5	9	17	20";const canvas=document.getElementById('canvas');
const context=canvas.getContext('2d');
context.fillStyle='blue';
var replace=0; // holds alpha id for num click replacement
var img=new Image(30,30);
var data=matrixdata.split("\t");// needs terminal tab to get all elements
var english=efreq.split(",");

function showmatrix(){// shows data array, modified by clicks
var text="";
var tc=0;
  for(i=0;i<data.length;i++){
   if(data[i]==0) text+="<img id='d"+i+"' src=black.png>";
      else 
    if(data[i]<27)text+="<img id='d"+i+"' src="+data[i]+".png>";
             else text+="<img id='d"+i+"' src='alphabit"+data[i]+".png'>";//show fixed clue
    if((i%15)==14)text+="<br>";
  } 
    text="<div class='div1' align='left' ><img src='showplot.png' onclick='chartfreqs()' ><img  src='showmatrix.png' onclick='showmatrix()' ></div>"+text;
    document.getElementById('matrix').innerHTML=text;
    for(i=1;i<27;i++)document.getElementById('n'+i).src=i+".png";//on show matrix reset number line
    showclues();
}

function showclues(){//place three given clues as alpha on the number line
var c=clues.split(",");
for(i=1;i<26;i++){
  for(cl=0;cl<c.length;cl+=2)if(i==c[cl+1])document.getElementById('n'+i).src='alphabit'+c[cl]+'.png';//replace number line element by alpha clue
  }
  for(i=1;i<data.length;i++){
    for(cl=0;cl<c.length;cl+=2)if(data[i]==c[cl+1])data[i]=c[cl];//replace data element by alpha clue (9 becomes "M")
  }
}

function drawBar(ctx, upperLeftCornerX, upperLeftCornerY, width, height,color){
    ctx.save();
    ctx.fillStyle=color;
    ctx.fillRect(upperLeftCornerX,upperLeftCornerY,width,height);
    ctx.restore();
}
function calcfreqs(){
for(i=0;i<26;i++)freq[i]=0;
for(i=0;i<data.length;i++) if(data[i]!=0)freq[parseInt(data[i])-1]+=1;
}

function chartfreqs(){
var textnums="";
var textalphs="";
var c=clues.split(",");
calcfreqs();
context.lineWidth=2;
context.beginPath();context.moveTo(5,255-5*freq[0]);
for(i=0;i<freq.length;i++){
context.lineTo(17+(i)*30,255-5*freq[i]);
//img=new Image(30,30);
//img.id='i+1';img.src=i+1+'.png';
drawBar(context,3+i*30,255-5*freq[i],30,5*freq[i],'#CCCCDD');
context.font = "bold 15px Arial";
context.fillStyle="#0000ff";
context.fillText(freq[i],12+i*30,250-5*freq[i]);
//document.getElementById('div1').appendChild(img);//add <img 1-26> in javascript not provide 'onclick' with new images
 textnums+="<img id='n"+(i+1)+"' src='"+(i+1)+".png' onclick='nclick("+(i+1)+")' >";
 var source="alphabit"+String.fromCharCode(65+i)+".png";
 textalphs+="<img id='a"+(i+1)+"' src='"+source+"' onclick='aclick("+(i+1)+")' >";
 context.stroke();
 }
document.getElementById('div1').innerHTML=textnums+"<br>"+textalphs;
// now plot english comparison data
context.beginPath();context.moveTo(5,100-5*english[0]);
context.fillStyle="#ffaaaa";
context.strokeStyle="#ffaaaa";
context.fillText("English frequencies A-Z %",5,20);
context.fillStyle="#0000ff";
context.fillText("This matrix",5,135);
context.fillStyle="#ffaaaa";
for(i=0;i<english.length;i++){
context.lineTo(15+(i)*30,100-5*english[i]);
context.fillText(String.fromCharCode(i+65),5+i*30,100);
}
context.moveTo(5,105);context.lineTo(canvas.width,105);
context.stroke();
showclues();
}

function nclick(){//click on number in row - replace image with alphachoice
if(replace!=0){
 document.getElementById('n'+arguments[0]).src="alphabit"+String.fromCharCode(64+replace)+".png";
 for(i=0;i<data.length;i++)if(data[i]==arguments[0])document.getElementById('d'+i).src="alphabit"+String.fromCharCode(64+replace)+".png";
 //document.getElementById('d0').src="alphabit"+String.fromCharCode(65)+".png";
 replace=0;
 }
}

function aclick(){//click on alpha in row - set id for num to use as replacement
 replace=arguments[0];
}
</script>
</head>
<body>
You are given three letters to start with - M-9 , N-13 and G-19<br>

<div class='rectangle'></div>
</body>
</html> 